# 무작위 대조 실험

무작위 대조 실험(Randomized Control Trial, RCT)을 이야기 하기 앞서 우리는 어떻게 어떤 것의 효과를 알 수 있는지 생각해 보자.

사람의 면역이라는 것은 사람마다 다르기 때문에 어떤 사람은 백신이 없어도 코로나에 안걸릴 수 있고 어떤 사람은 다른 사람들 보다 쉽게 코로나에 거릴 수 있다. 

그래서 만약에 우리가 백신의 효능을 측정하는 데 한 사람은 90대 어르신이고 한사람은 20대 건장한 사람이라고 해서 20대 청년에게는 백신을 주고 90대 어르신에게는 백신을 맞추지 않게 실험을 했다고 한다면 우리는 이 결과를 믿을 수 있을까?

아마 대부분의 사람들은 다르게 생각할 것이다. 왜냐하면 건강한 사람과 그렇지 않은 사람을 대상으로 비교 했기 때문이다. 백신 때문에 20대 청년이 건강한 것인지 아니면 단지 젊어서 더 건강했던 것인지 우리는 알 수 없기 때문이다. 실험에 참가하는 사람이 근본적으로 다른 상황에서 비교를 하는 것은 맞지 않다.

그렇기 때문에 어떤 것의 효과를 이해하기 위해서는 완전히 동등한 한 쌍이 필요하다. 한 사람에게는 주고 완전히 동일한 다른 한 사람에게는 주지 않아서 그 이후 발생하는 차이는 그 행위 혹은 물질의 효과로 보는 것이다. 

이 아이디어에는 치명적인 문제가 있는데 우리는 완전히 동일한 한쌍의 사람을 구할 수 없다는 점이다. 쌍둥이라고 하더라도 자라난 환경이 미묘하게 다를 수 밖에 없는데 그 차이가 효과의 차이를 일으키지 않는다고 어떻게 보장할 수 있겠는가?

이런 문제를 해결하는 방법으로 등장하는 것이 RCT다. RCT는 단어는 생소할 지 몰라도 아이디어는 아주 간단하다. 무작위로 사람들을 구분한다면 우리가 관찰 할 수 없는 부분 까지도 모두 포함하여 두 집단은 통계적으로 아주 유사한 집단이 된다는 점이다. 공정하게 동전을 던지듯 이렇게 통계적으로 동등한 두 집단을 만들어서 한 집단에는 백신을 놔주고 다른 집단에는 백신처럼 보이는 플라시보 물질을 주입하는 것이다. 

한 사람 한 사람은 다르겠지만 집단의 성질은 통계적으로 일정 범주 안에서 동등하다. 그렇게 실험을 한 결과를 비교하면 우리는 그 효능을 상당히 신뢰할 수 있을 것이다.

# 오래된 법칙 : GIGO

데이터가 쓰레기면 결과도 쓰레기다.

# 얼마나 정확한 걸까?(Knowing uncertainty) 

운이 좋아서 혹은 나빠서 100명중 1명이 100명 중 2명이 되었다면 결과는 얼마나 차이나게 될까? 단순하게 생각해 보면 2배 차이가 나게 된다. 
확률은 평균적으로 1.1명일 수 있지만 우리가 관찰 하는 값은 걸렸거나 안걸렸거나 하는 현실에 살고 있기 때문이다.

그래서 100명 중 1명과 1000명 중 10명은 같은 비율이지만 1명이 확률적으로 더 생겼을 때 결과에 영향을 주는 범주는 100% 대 10%로 아주 크게 차이가 나게 된다.

이러한 불확실성을 아는 것이 정책 결정에 아주 중요한 요소가 될 것이다.

그렇다면 백신 예방효과의 불확실성을 계량해 보자.


작은 모델에서 부터 시작한다.

10명이 있었을 때 4명이 양성이면 양성 비율은 몇펴센트일까?

간단하게 생각하면 0.4(40%)로 볼 것이다.

그런데 확률적으로 0.39도 가능할 것이고 0.41도 가능할 것이다.

그렇다면, 우리는 어떻게 계산해 볼 수 있을까?


베이지안적인 아이디어로 반대로 생각해 보자.

10명 중 4명이 양성이었을 때 유병률이 0.4 일 확률을 생각해보자.

베이즈 정리를 생각해 보자면, 데이터가 주어졌을 때 가설이 참 일 확률은 가설이 참일 거라 생각하는 확률과 가설에서 데이터가 나올 확률의 곱과 같다.

$$P(H|\text{data}) \propto P(H) \cdot P(\text{data}|H)$$

따라서, 
$$
\begin{align}
       P(H=0.4|\text{4 positives,  6 negatives}) &\propto P(H=0.4) \times P(\text{4 positives, 6 negatives}|H=0.4) \\
       &= P(H=0.4) \times (0.4)^4 \cdot (0.6)^6
\end{align}
$$

# 베이즈 법칙

계량을 하기 앞서 한가지 정리해 보고 가야 할 부분이 있다. 바로 베이지안 통계 모델의 근본이 되는 베이즈 법칙이다. 

사실 베이즈 법칙은 조건부확률의 정의에서 자연스럽게 도출 된다.

# Grid vs. MCMC


# 시간에 따라 변화한다는 것은